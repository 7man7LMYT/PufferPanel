language: go
env:
- GO_ENV=test

go:
  - 1.8.x

go_import_path: github.com/pufferpanel/pufferpanel

services:
  - mysql

before_install:
  - . $HOME/.nvm/nvm.sh
  - nvm install stable
  - nvm use stable

before_script:
  - psql -c 'create database pufferpanel_test;' -U postgres
  - mysql -e 'CREATE DATABASE pufferpanel_test;'
  - mkdir -p $TRAVIS_BUILD_DIR/public/assets
  - go get -u -v github.com/gobuffalo/buffalo/buffalo

script:
  - cd $TRAVIS_BUILD_DIR
  - npm install
  - buffalo db create -e test
  - buffalo db migrate
  - buffalo build
