{% extends "admin_base.html" %}

{% block title %}List All Nodes{% endblock %}

{% block content %}
<div class="col-9">
	<table class="table table-striped table-bordered table-hover">
		<thead>
			<tr>
				<th>Node Name</th>
				<th>Location</th>
				<th>IP Address</th>
				<th>FTP Address</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			{% for id, node in nodes %}
				<tr class="dynUpdate" id="{{ node.ip }}+{{ node.gsd_listen }}">
					<td><a href="view?id={{ node.id }}">{{ node.node }}</a></td>
					<td>{{ node.l_location }}</td>
					<td>{{ node.fqdn }}</td>
					<td>{{ node.ip }}</td>
					<td style="width:26px;"><i id="applyUpdate" class="fa fa-circle-o-notch fa-spinner fa-spin"></i></td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
</div>
{% endblock %}

{% block javascript %}
<script type="text/javascript">
	$(window).load(function(){
		$("#sidebar_links").find("a[href='/admin/node']").addClass('active');
		$(".dynUpdate").each(function() {
			var connection = $(this).attr("id");
			var element = $(this);
			$(this).find("#applyUpdate").addClass("fa-circle-o-notch fa-spinner fa-spin");
			$.ajax({
				type: "POST",
				url: "/ajax/status/node",
				data: { node: connection }
			}).done(function(data) {
				element.find("#applyUpdate").removeClass("fa-circle-o-notch fa-spinner fa-spin");
				element.find("#applyUpdate").addClass("fa-circle").css({"color": data});
			});
		});
	});
</script>
{% endblock %}